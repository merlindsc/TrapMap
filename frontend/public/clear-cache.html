<!DOCTYPE html>
<html>
<head>
    <title>Cache leeren - TrapMap</title>
    <meta charset="UTF-8">
</head>
<body>
    <h2>üßπ Cache leeren</h2>
    <button onclick="clearCache()">Service Worker Cache leeren</button>
    <div id="output"></div>
    
    <script>
    async function clearCache() {
        const output = document.getElementById('output');
        output.innerHTML = '<p>L√∂sche Cache...</p>';
        
        try {
            // Service Worker Cache l√∂schen
            if ('serviceWorker' in navigator) {
                const registrations = await navigator.serviceWorker.getRegistrations();
                for (let registration of registrations) {
                    await registration.unregister();
                    output.innerHTML += '<p>‚úÖ Service Worker deregistriert</p>';
                }
            }
            
            // Alle Caches l√∂schen
            const cacheNames = await caches.keys();
            for (const cacheName of cacheNames) {
                await caches.delete(cacheName);
                output.innerHTML += `<p>‚úÖ Cache gel√∂scht: ${cacheName}</p>`;
            }
            
            // Browser-Storage l√∂schen
            if ('indexedDB' in window) {
                indexedDB.deleteDatabase('trapmap-offline-db');
                output.innerHTML += '<p>‚úÖ IndexedDB gel√∂scht</p>';
            }
            
            localStorage.clear();
            sessionStorage.clear();
            output.innerHTML += '<p>‚úÖ Local/Session Storage gel√∂scht</p>';
            
            output.innerHTML += '<p><strong>üéâ Alle Caches gel√∂scht! Bitte Seite neu laden.</strong></p>';
            
        } catch (error) {
            output.innerHTML += `<p>‚ùå Fehler: ${error}</p>`;
        }
    }
    </script>
</body>
</html>